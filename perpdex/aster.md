# Aster 模型：创新型永续合约 AMM

## 1. 核心定位与设计理念
Aster 是由 Manta Pacific 生态系统中的 Cleopatra Exchange 提出的创新型 AMM 模型，专为永续合约交易设计，旨在解决传统 Perp DEX 面临的"流动性三角困境"（资本效率、风险隔离、可组合性难以兼得）。

## 2. 核心机制与工作原理
- **统一的 Aster 风险池**：所有 LP 将稳定币存入单一共享风险池，作为全局保险基金
- **独立的市场状态机**：每个交易对独立运营，记录虚拟做市商曲线、净头寸和累计损益
- **流动性簿记与损益结算**：
  - 开仓：记录交易账本，不直接动用池资金
  - 结算：盈利创建债务，亏损抵消债务
  - 债务平衡：仅当市场累计债务为负时，盈余才转入风险池
  - 风险隔离：各市场债务独立，无法相互抵消

## 3. 核心特色与优势
- 无损复合流动性：资金可同时支持多个交易对，资本效率极高
- 完全风险隔离：单一交易对亏损不影响其他交易对
- LP 友好：不暴露于特定资产价格波动，主要承担交易者整体盈亏风险
- 强大可组合性：单一池结构易于与其他 DeFi 协议集成
- 优秀交易者体验：深度统一，滑点低，支持长尾资产

## 4. 技术架构与发展
- **当前**：作为智能合约部署在 BNB Chain、以太坊、Arbitrum、Solana 等多链的 DApp
- **未来**：计划建设专用 Layer 1 区块链，优化交易性能

## 5. 双引擎交易架构

| 模式 | 交易模型 | 目标用户 | 核心特色 | 费用 |
|------|----------|----------|----------|------|
| **专业模式** | 中心化限价订单簿 | 专业交易者、机构 | 支持限价单、隐藏订单、网格交易 | 挂单0.01%，吃单0.035% |
| **简单模式(1001x)** | 基于 ALP 池的 AMM | 散户、高杠杆偏好者 | 最高1001倍杠杆、抗MEV、零滑点 | 通常零开仓费 |

## 6. 三种交易模式
- **Perpetual Mode (Pro)**：永续合约，订单簿界面，支持限价单和隐藏订单
- **1001x**：永续合约，链上流动性，一键高杠杆交易
- **Spot mode**：现货交易，订单簿界面，支持限价单

## 7. 限价单实现机制
Aster 通过**原生订单簿（CLOB）**技术实现限价单功能，主要在专业模式（Pro Mode）和现货模式（Spot mode）中支持。作为组合约系统，Aster采用了创新的链上链下协同架构来实现中心化限价订单簿。

### 核心实现原理

#### 1. 组合约结构下的订单簿架构
Aster作为组合约系统，将订单簿功能拆分为多个协同工作的智能合约模块：
- **订单管理合约**：负责接收、验证和存储用户订单
- **撮合引擎合约**：处理订单匹配逻辑，维护价格-时间优先级
- **清算结算合约**：处理成交后的资金结算和状态更新
- **市场状态合约**：管理各交易对的市场数据和状态

每个交易对都有独立的订单簿实例，与对应市场的状态机关联，确保风险隔离。

#### 2. 链上链下协同机制
Aster采用**混合架构**实现高效的订单簿功能：
- **链上部分**：
  - 订单的提交、验证、取消等关键操作在智能合约上执行
  - 成交结果和市场状态的最终确认在链上完成
  - 确保交易的安全性和不可篡改性

- **链下部分**：
  - 订单簿的实时维护和撮合计算在高性能服务器上执行
  - 采用传统中心化交易所的CLOB技术栈，支持高频交易
  - 提供接近CEX的低延迟和高吞吐量

#### 2.1 多链部署下的链下服务架构
由于Aster部署在BNB Chain、以太坊、Arbitrum、Solana等多条链上，它采用**链特定的链下服务架构**：

1. **独立的链下服务实例**：
   - 每条链都配备独立的链下订单簿服务实例
   - 每个实例专门为对应链的性能特性进行优化
   - 确保一条链的服务故障不影响其他链的正常运行

2. **独立部署的原因**：
   - **链性能差异**：不同区块链的吞吐量、延迟、手续费差异显著，需要针对性优化
   - **风险隔离**：符合Aster的核心设计理念，避免跨链风险传导
   - **智能合约交互效率**：本地部署的链下服务可显著降低与链上合约交互的延迟
   - **链生态适配**：不同链的生态系统（钱包、工具、开发环境）各不相同，便于适配
   - **监管合规考量**：不同地区对不同区块链的监管要求可能不同，便于满足各地区合规需求

3. **跨链协同机制**：
   - 虽然各链服务独立运行，但设置了**统一的管理和监控层**
   - 提供跨链服务状态监控和告警
   - 统一的用户界面和API接口，简化用户体验
   - 跨链流动性管理策略，优化资金利用
   - 全局风险控制机制，确保整体系统安全

#### 3. 订单生命周期管理
1.  **订单提交**：
   - 用户通过DApp提交限价单请求
   - 智能合约验证用户资金、权限和订单参数
   - 验证通过后，链下撮合引擎接收订单并加入订单簿
   - 同时在链上记录订单的哈希和关键参数

2.  **订单匹配**：
   - 链下撮合引擎实时监控所有活跃订单
   - 采用价格优先、时间优先的撮合算法
   - 匹配成功后生成成交记录，并提交到链上验证
   - 隐藏订单直接进入撮合引擎，不显示在公共订单簿

3.  **成交结算**：
   - 智能合约验证成交记录的有效性
   - 扣除交易费用，更新用户保证金和头寸
   - 更新市场状态机的账本记录
   - 更新风险池的债务状态

4.  **订单取消**：
   - 用户可通过DApp请求取消未成交订单
   - 链下撮合引擎移除订单并通知链上
   - 智能合约确认取消并释放锁定的资金

#### 4. 隐藏订单（Hidden Orders）机制
   - 大额交易者可选择提交隐藏订单
   - 隐藏订单不会在公共订单簿上显示任何信息
   - 订单直接进入主撮合引擎，仅在成交后才会显现
   - 有效防止抢跑（front-running）和减少价格影响

#### 5. 技术保障
   - 订单簿通过智能合约实现链上验证，确保交易公平性
   - 结合链下计算优化，提供接近CEX的撮合成交速度
   - 支持MEV防护，保护交易者免受恶意三明治攻击
   - 采用分片技术处理多交易对的订单簿，提高系统扩展性

### 与传统中心化交易所的区别
| 特性 | Aster 组合约订单簿 | 传统中心化交易所订单簿 |
|------|-------------------|------------------------|
| 交易最终性 | 链上智能合约确认 | 中心化服务器确认 |
| 资金安全性 | 用户自行保管私钥 | 交易所托管资金 |
| 透明度 | 成交记录公开可查 | 内部撮合，透明度有限 |
| 可组合性 | 可与其他DeFi协议集成 | 封闭系统 |
| 扩展性 | 受限于区块链性能 | 高扩展性 |
| 延迟 | 微秒级（链下）+ 秒级（链上确认） | 微秒级 |

### 限价单支持范围
| 交易模式 | 支持限价单 | 支持隐藏订单 | 核心优势 |
|----------|------------|--------------|----------|
| Perpetual Mode (Pro) | ✅ 是 | ✅ 是 | 适合机构和专业交易者，提供完整的高级订单工具 |
| 1001x | ❌ 否 | ❌ 否 | 专注高杠杆一键交易，不提供限价单功能 |
| Spot mode | ✅ 是 | ✅ 是 | 提供与CEX类似的现货交易体验 |

## 8. 潜在风险与挑战
- 系统性黑天鹅风险：多市场同时债务危机
- 模型复杂性与验证压力：尚未经历完整牛熊周期
- 高杠杆系统性风险：1001倍杠杆易引发连锁清算
- 代币经济风险：53.5%的空投可能带来长期抛压

## 9. 代币经济学
- 代币：$ASTER，总供应量80亿枚，固定总量
- 分配：53.5%用于社区空投，5%团队份额（长期锁仓）
- 机制：包含销毁机制对抗通胀

## 10. 与主流模型对比
Aster 模型在资本效率、风险隔离和可组合性三方面实现了突破性平衡，超越了 vAMM、GLP 和 Synthetix 等传统模型的局限性。

总结：Aster 通过"中央风险池 + 独立市场记账 + 债务清算"的三层架构，将 LP 角色从"特定资产做市商"转变为"交易所承保人"，是 Perp DEX 赛道的重要机制创新。